<?php
/**
 * MalwareCheck
 *
 * @version 0.1
 * @author Jan Bouma | SoHosted
 */
define('MALWARECHECK_VERSION', '0.1');
error_reporting(E_ALL | E_STRICT);

require_once('./app/bootstrap.php');

$app->check('../');
?>
<!DOCTYPE html>
<html>
<head>
	<meta charset='UTF-8' />
	<title>MalwareCheck <?=MALWARECHECK_VERSION ?></title>
	<link rel='icon' type='image/x-icon' href='/favicon.ico' />
	<!-- Bootstrap -->
	<link rel='stylesheet' href='./libs/bootstrap/css/bootstrap.min.css' />
	<link rel='stylesheet' href='./libs/bootstrap/css/bootstrap-theme.min.css' />
	<link rel='stylesheet' href='./app/application.css' />
</head>
<body><div id='viewport'>
<div class='container-fluid'>
<div class='row'>
<div class='col-md-9'>
<h1>MalwareCheck <?=MALWARECHECK_VERSION ?></h1>
<p>This script check the given webroot folder for suspicious filenames, and fingerprints in file contents.</p>
<div>
Checked Path: <tt><?php print ($app->getCheckPath()); ?></tt>
</div>
<hr /><a name='#hits'></a>
<h2>Hits</h2>
<hr /><a name='#hitsFiles'></a>
<h3>Files</h3>
<?php
echo $app->renderFilesFound();
?>
<hr /><a name='#hitsPatterns'></a>
<h3>Patterns</h3>
<?php
echo $app->renderPatternsFound();
?>
<hr /><a name='#log'></a>
<h3>Log</h3>
<div class='panel panel-default'>
<?php
//echo $app->renderLog();
?>
</div>
</div><!--col-md-9-->
<div class='col-md-3'>
<div class='sidebar'>
<ul class='nav nav-stacked'>
	<li role='presentation'><a href='#'>Home</a></li>
	<li role='presentation'><a href='#hits'>Hits</a></li>
	<li role='presentation'><a href='#hitsFiles'>&nbsp;&raquo; Files</a></li>
	<li role='presentation'><a href='#hitsPatterns'>&nbsp;&raquo; Patterns</a></li>
	<li role='presentation'><a href='#log'>Log</a></li>
</ul>
<hr />
<h2>Stats</h2>
<?php
$scanner = $app->getScanner();
?>
<ul>
	<li>Directories scanned: <?php echo $scanner->getDirectoriesScannedCount(); ?></li>
	<li>Directories ignored: <?php echo $scanner->getDirectoriesIgnoredCount(); ?></li>

	<li>Files scanned: <?php echo $scanner->getFilesScannedCount(); ?></li>
	<li>Empty files: <?php echo $scanner->getFilesScannedEmptyCount(); ?></li>

	<li>Patterns found: <?php echo $scanner->getPatternsFoundCount(); ?></li>

	<li>File hash errors: <?php echo $scanner->getWordpressFileHashErrors(); ?></li>
</ul>
</div><!--sidebar-->
</div><!--col-md-3-->
</div><!--row-->
</div><!--container-->
</div><!--viewport-->
<script src='./libs/jquery/jquery-1.11.1.min.js'></script>
<script src='./libs/bootstrap/js/bootstrap.min.js'></script>
<script src='//google-code-prettify.googlecode.com/svn/loader/run_prettify.js'></script>
</body>
</html>
